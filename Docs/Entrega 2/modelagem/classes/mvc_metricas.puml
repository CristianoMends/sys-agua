@startuml
skin rose
title Diagrama MVC - MÃ©tricas (Spring Framework)

package "Model" {
    class Transacao {
        - id: Long
        - valor: double
        - tipo: TipoTransacao
        - data: LocalDateTime
    }

    enum TipoTransacao {
        RECEITA
        DESPESA
        ESTORNO
        TRANSFERENCIA
    }
}

package "Repository" {
    class TransacaoRepository {
        + findByDataBetween(startDate: LocalDate, endDate: LocalDate): List<Transacao>
    }

    class PedidoRepository {

        + findByDataBetween(startDate: LocalDate, endDate: LocalDate): List<Pedido>
    }
}

package "Service" {
    class MetricasService {
        + calcularReceitaTotal(startDate: LocalDate, endDate: LocalDate): double
        + calcularDespesaTotal(startDate: LocalDate, endDate: LocalDate): double
        + calcularLucro(startDate: LocalDate, endDate: LocalDate): double
        + obterProdutosMaisVendidos(startDate: LocalDate, endDate: LocalDate): List<Produto>
        + obterTransacoesDetalhadas(startDate: LocalDate, endDate: LocalDate): List<Transacao>
    }
}

package "Controller" {
    class MetricasController {
        + obterProdutosMaisVendidos(startDate: LocalDate, endDate: LocalDate): List<Produto>
        + obterTransacoesDetalhadas(startDate: LocalDate, endDate: LocalDate): List<Transacao>
        + exportarDados(startDate: LocalDate, endDate: LocalDate): File
    }
}

package "View" {
    class MetricasView {
        + exibirProdutosMaisVendidos(): void
        + filtrarPorPeriodo(): void
        + exibirGraficosReceitaDespesa(): void
        + exibirTabelaDetalhadaTransacoes(): void
        + exportarDadosCSV(): void
        + enviarRelatorioEmail(): void
    }
}

MetricasView --> MetricasController: "filtrarPorPeriodo()"
MetricasView --> MetricasController: "exibirResumo()"
MetricasView --> MetricasController: "obterProdutosMaisVendidos()"
MetricasView --> MetricasController: "exportarDadosCSV()"
MetricasView --> MetricasController: "enviarRelatorioEmail()"
MetricasView --> MetricasController: "obterTransacoesDetalhadas()"
MetricasController --> MetricasService
MetricasService --> TransacaoRepository
MetricasService --> PedidoRepository
TransacaoRepository --> Transacao
Transacao -> TipoTransacao
PedidoRepository --> Pedido

@enduml
